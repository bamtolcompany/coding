<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>íŒŒì´ì¬ ì—ë””í„°</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <style>
  .hidden {
  display: none;
}
#toggleBtn {
  background: none;
  color: #0e90d2;
  border: none;
  cursor: pointer;
  font-size: 14px;
  margin-left: 10px;
}
#toggleBtn:hover {
  text-decoration: underline;
}
    body { font-family: monospace; background: #1e1e1e; color: white; padding: 20px; }
    textarea { width: 100%; height: 300px; background: #252526; color: #d4d4d4; font-size: 16px; border: none; padding: 10px; }
    button { padding: 10px 20px; margin-top: 10px; background: #0e639c; color: white; border: none; cursor: pointer; }
    pre { background: #333; padding: 10px; overflow: auto; white-space: pre-wrap; }
ul {
  list-style: none;
  padding: 0;
  margin-top: 10px;
  max-width: 600px;
}
li {
  background: #2d2d2d;
  padding: 10px 15px;
  margin-bottom: 6px;
  border-radius: 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: background 0.2s;
}
li:hover {
  background: #3a3a3a;
}
.filename {
  font-size: 16px;
  cursor: pointer;
}
.trash {
  font-size: 16px;
  cursor: pointer;
  color: #ff5c5c;
  transition: color 0.2s;
}
.trash:hover {
  color: #ff1f1f;
}
  </style>
</head>
<body>
  <h1>íŒŒì´ì¬ ì—ë””í„°</h1>
  <a href="terminal.html" style="color:white;">í„°ë¯¸ë„ ìŠ¤íƒ€ì¼ ì—ë””í„° ì—´ê¸°</a><br /><br />
  <textarea id="code">print("Hello Python")</textarea><br />

  <button onclick="runPython()">ì½”ë“œ ì‹¤í–‰</button>
  <button onclick="saveCode()">ì½”ë“œ ì €ì¥</button>

<h2>
  ì €ì¥ëœ ì½”ë“œ:
  <button onclick="toggleCodeList()" id="toggleBtn">ìˆ¨ê¸°ê¸°</button>
</h2>
<ul id="codeList"></ul>
  <h2>ê²°ê³¼:</h2>
  <pre id="output">ë¡œë”©ì¤‘...</pre>

  <script>
    let pyodideReady = false;
    let pyodide;

    async function loadPyodideAndPackages() {
      pyodide = await loadPyodide();
      pyodideReady = true;
      document.getElementById("output").textContent = "ë¡œë”© ì™„ë£Œ";
    }

    async function runPython() {
      if (!pyodideReady) {
        document.getElementById("output").textContent = "ì•„ì§ ë¡œë”©ì´ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤...";
        return;
      }

      const code = document.getElementById("code").value;

      try {
        await pyodide.runPythonAsync(`
import sys
from io import StringIO
sys.stdout = mystdout = StringIO()
sys.stderr = mystderr = StringIO()
        `);

        await pyodide.runPythonAsync(code);

        const stdout = pyodide.runPython("mystdout.getvalue()");
        const stderr = pyodide.runPython("mystderr.getvalue()");

        document.getElementById("output").textContent = stdout + (stderr ? `\n[stderr]\n${stderr}` : "");
      } catch (err) {
        document.getElementById("output").textContent = "JavaScript error:\n" + err;
      }
    }

    function saveCode() {
      const name = prompt("íŒŒì¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:");
      if (!name) return;

      const code = document.getElementById("code").value;
      localStorage.setItem(`code_${name}`, code);
      alert("ì €ì¥ ì™„ë£Œ!");
      loadCodeList();
    }

    function loadCodeList() {
  const list = document.getElementById("codeList");
  list.innerHTML = "";

  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key.startsWith("code_")) {
      const filename = key.replace("code_", "");
      const li = document.createElement("li");

      const span = document.createElement("span");
      span.className = "filename";
      span.textContent = filename;

      const trash = document.createElement("span");
      trash.className = "trash";
      trash.textContent = "ğŸ—‘ï¸";
      trash.title = "ì‚­ì œ";

      trash.onclick = function (e) {
        e.stopPropagation(); // ì‚­ì œ í´ë¦­ ì‹œ ë¶€ëª¨(li) í´ë¦­ ì•ˆ ë˜ê²Œ ë§‰ìŒ
        if (confirm(`${filename}ì„(ë¥¼) ì‚­ì œí• ê¹Œìš”?`)) {
          localStorage.removeItem(key);
          loadCodeList();
        }
      };

      // li í´ë¦­ ì‹œ ì½”ë“œ ë¡œë“œ (íœ´ì§€í†µ ëˆ„ë¥¸ ê²Œ ì•„ë‹ ë•Œë§Œ)
      li.onclick = function () {
        document.getElementById("code").value = localStorage.getItem(key);
      };

      li.appendChild(span);
      li.appendChild(trash);
      list.appendChild(li);
    }
  }
}
    loadPyodideAndPackages();
    loadCodeList();
  function toggleCodeList() {
  const list = document.getElementById("codeList");
  const btn = document.getElementById("toggleBtn");

  if (list.classList.contains("hidden")) {
    list.classList.remove("hidden");
    btn.textContent = "ìˆ¨ê¸°ê¸°";
  } else {
    list.classList.add("hidden");
    btn.textContent = "ë³´ì´ê¸°";
  }
}
  </script>
</body>
</html>
